<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

<div class="dashboard">
  <h1>Course Dashboard</h1>

  <button class="btn btn-primary" (click)="showCreateCourseForm()">Create Course</button>

<div *ngIf="isCreateCourseVisible" class="form-container">
  <h2>Create Course</h2>
  <form (ngSubmit)="createCourse()" enctype="multipart/form-data">
    <div class="form-group">
      <label for="title">Course Title:</label>
      <input type="text" id="title" [(ngModel)]="newCourse.title" name="title" required>
    </div>
    <div class="form-group">
      <label for="description">Description:</label>
      <textarea id="description" [(ngModel)]="newCourse.description" name="description" required></textarea>
    </div>
    <div class="form-group">
      <label for="category">Category:</label>
      <input type="text" id="category" [(ngModel)]="newCourse.category" name="category" required>
    </div>
    <div class="form-group">
      <label for="tags">Tags (comma separated):</label>
      <input type="text" id="tags" [(ngModel)]="newCourse.tags" name="tags" required>
    </div>
    <div class="form-group">
      <label for="image">Course Image:</label>
      <input type="file" id="image" (change)="onImageSelected($event)" required>
    </div>
    <button type="submit" class="btn btn-success">Create Course</button>
    <button type="button" class="btn btn-secondary" (click)="isCreateCourseVisible = false">Cancel</button>
  </form>
</div>

  <div *ngFor="let course of courses" class="course-card">
    <h3>{{ course.title }}</h3>
    <p>{{ course.description }}</p>
    <div class="course-actions">
      <button class="btn btn-danger" (click)="deleteCourse(course._id)">Delete</button>
      <button class="btn btn-warning" (click)="showUpdateCourseForm(course)">Update</button>
      <button class="btn btn-info" (click)="showAddLessonForm(course)">Add Lesson</button>
    </div>

    <div *ngIf="isAddLessonVisible && currentCourseId === course._id" class="form-container">
      <h4>Add Lesson</h4>
      <form (ngSubmit)="createLesson()"> 
        <div class="form-group">
          <label for="lessonTitle">Lesson Title:</label>
          <input type="text" id="lessonTitle" [(ngModel)]="newLesson.title" name="lessonTitle" required>
        </div>
        <div class="form-group">
          <label for="lessonContent">Lesson Content:</label>
          <textarea id="lessonContent" [(ngModel)]="newLesson.content" name="lessonContent" required></textarea>
        </div>
        <button type="submit" class="btn btn-success">Create Lesson</button>
        <button type="button" class="btn btn-secondary" (click)="isAddLessonVisible = false">Cancel</button>
      </form>
    </div>

    <div *ngFor="let lesson of course.lessons" class="lesson-card">
      <h5>{{ lesson.title }}</h5>
      <p>{{ lesson.content }}</p>
      <div class="lesson-actions">
        <button class="btn btn-primary" (click)="showUploadMaterialsForm(course._id, lesson._id)">Upload Materials</button>
        <button class="btn btn-warning" (click)="showUpdateLessonForm(lesson)">Update Lesson</button>
      </div>

<div *ngIf="isUploadMaterialsVisible && currentCourseId === course._id && currentLessonId === lesson._id" class="form-container">
  <h5>Upload Materials</h5>
  <form (ngSubmit)="uploadMaterials(course._id, lesson._id)" enctype="multipart/form-data">
    <div class="form-group">
      <label for="materialVideo">Video:</label>
      <input type="file" id="materialVideo" (change)="onFileSelected($event)" name="video" required>
    </div>
    <div class="form-group">
      <label for="materialTitle">Title:</label>
      <input type="text" id="materialTitle" [(ngModel)]="newMaterial.title" name="materialTitle" required>
    </div>
    <div class="form-group">
      <label for="materialDescription">Description:</label>
      <textarea id="materialDescription" [(ngModel)]="newMaterial.description" name="materialDescription" required></textarea>
    </div>
    <div class="form-group">
      <label for="materialDuration">Duration:</label>
      <input type="text" id="materialDuration" [(ngModel)]="newMaterial.duration" name="materialDuration" required>
    </div>
    <button type="submit" class="btn btn-success">Upload Material</button>
    <button type="button" class="btn btn-secondary" (click)="isUploadMaterialsVisible = false">Cancel</button>
  </form>
</div>


      <div *ngFor="let material of lesson.learningMaterials" class="material-card">
        <h5>{{ material.title }}</h5>
        <p>{{ material.description }}</p>
        <button class="btn btn-danger" (click)="deleteMaterial(course._id,lesson._id, material._id)">Delete Material</button>
        <button class="btn btn-success" (click)="showAddQuizForm(course._id, lesson._id)">Add Quiz</button>

        <div *ngIf="isAddQuizVisible && currentCourseId === course._id && currentLessonId === lesson._id" class="form-container">
          <h5>Add Quiz</h5>
          <form (ngSubmit)="createQuiz(lesson._id)">
            <div class="form-group">
              <label for="quizTitle">Quiz Title:</label>
              <input type="text" id="quizTitle" [(ngModel)]="newQuiz.title" name="quizTitle" required>
            </div>
        
            <div *ngFor="let question of newQuiz.questions; let i = index" class="form-group">
              <label for="question{{ i }}">Question {{ i + 1 }}:</label>
              <input type="text" id="question{{ i }}" [(ngModel)]="question.question" name="question{{ i }}" required>
        
              <label for="options{{ i }}">Options (comma-separated):</label>
              <input type="text" id="options{{ i }}" [(ngModel)]="question.options" name="options{{ i }}" required>
        
              <label for="correctAnswer{{ i }}">Correct Answer:</label>
              <input type="text" id="correctAnswer{{ i }}" [(ngModel)]="question.correctAnswer" name="correctAnswer{{ i }}" required>
            </div>
        
            <button type="button" class="btn btn-info" (click)="addAnotherQuestion()">Add Another Question</button>
        
            <button type="submit" class="btn btn-success">Submit Quiz</button>
            <button type="button" class="btn btn-secondary" (click)="isAddQuizVisible = false">Cancel</button>
          </form>
        </div>        
      </div>
    </div>
  </div>
</div> -->


<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

<div class="dashboard">
  <h1>Course Dashboard</h1>

  <!-- Create Course Button -->
  <button class="btn btn-primary" (click)="showCreateCourseForm()">Create Course</button>

  <!-- Create Course Form Modal -->
  <div *ngIf="isCreateCourseVisible" class="form-modal">
    <div class="form-container">
      <h2>Create Course</h2>
      <form (ngSubmit)="createCourse()" enctype="multipart/form-data">
        <div class="form-group">
          <label for="title">Course Title:</label>
          <input type="text" id="title" [(ngModel)]="newCourse.title" name="title" required>
        </div>
        <div class="form-group">
          <label for="description">Description:</label>
          <textarea id="description" [(ngModel)]="newCourse.description" name="description" required></textarea>
        </div>
        <div class="form-group">
          <label for="category">Category:</label>
          <input type="text" id="category" [(ngModel)]="newCourse.category" name="category" required>
        </div>
        <div class="form-group">
          <label for="tags">Tags (comma separated):</label>
          <input type="text" id="tags" [(ngModel)]="newCourse.tags" name="tags" required>
        </div>
        <div class="form-group">
          <label for="image">Course Image:</label>
          <input type="file" id="image" (change)="onImageSelected($event)" required>
        </div>
        <button type="submit" class="btn btn-success mx-1">Create Course</button>
        <button type="button" class="btn btn-secondary mx-1" (click)="isCreateCourseVisible = false">Cancel</button>
      </form>
    </div>
  </div>

  <!-- Created Courses Section -->
  <div *ngFor="let course of courses" class="course-card">
    <h3>{{ course.title }}</h3>
    <p>{{ course.description }}</p>
    <div class="course-actions">
      <button class="btn btn-danger mx-1" (click)="deleteCourse(course._id)">Delete</button>
      <button class="btn btn-warning mx-1" (click)="showUpdateCourseForm(course)">Update</button>
      <button class="btn btn-info mx-1" (click)="showAddLessonForm(course)">Add Lesson</button>
    </div>

    <!-- Add Lesson Form Modal -->
    <div *ngIf="isAddLessonVisible && currentCourseId === course._id" class="form-modal">
      <div class="form-container">
        <h4>Add Lesson</h4>
        <form (ngSubmit)="createLesson()">
          <div class="form-group">
            <label for="lessonTitle">Lesson Title:</label>
            <input type="text" id="lessonTitle" [(ngModel)]="newLesson.title" name="lessonTitle" required>
          </div>
          <div class="form-group">
            <label for="lessonContent">Lesson Content:</label>
            <textarea id="lessonContent" [(ngModel)]="newLesson.content" name="lessonContent" required></textarea>
          </div>
          <button type="submit" class="btn btn-success">Create Lesson</button>
          <button type="button" class="btn btn-secondary" (click)="isAddLessonVisible = false">Cancel</button>
        </form>
      </div>
    </div>

    <!-- Lessons Section -->
    <div *ngFor="let lesson of course.lessons" class="lesson-card">
      <h5>{{ lesson.title }}</h5>
      <p>{{ lesson.content }}</p>
      <div class="lesson-actions">
        <button class="btn btn-primary" (click)="showUploadMaterialsForm(course._id, lesson._id)">Upload
          Materials</button>
        <button class="btn btn-warning" (click)="showUpdateLessonForm(lesson)">Update Lesson</button>
      </div>

      <!-- Upload Materials Form Modal -->
      <div *ngIf="isUploadMaterialsVisible && currentCourseId === course._id && currentLessonId === lesson._id"
        class="form-modal">
        <div class="form-container">
          <h5>Upload Materials</h5>
          <form (ngSubmit)="uploadMaterials(course._id, lesson._id)" enctype="multipart/form-data">
            <div class="form-group">
              <label for="materialVideo">Video:</label>
              <input type="file" id="materialVideo" (change)="onFileSelected($event)" name="video" required>
            </div>
            <div class="form-group">
              <label for="materialTitle">Title:</label>
              <input type="text" id="materialTitle" [(ngModel)]="newMaterial.title" name="materialTitle" required>
            </div>
            <div class="form-group">
              <label for="materialDescription">Description:</label>
              <textarea id="materialDescription" [(ngModel)]="newMaterial.description" name="materialDescription"
                required></textarea>
            </div>
            <div class="form-group">
              <label for="materialDuration">Duration:</label>
              <input type="text" id="materialDuration" [(ngModel)]="newMaterial.duration" name="materialDuration"
                required>
            </div>
            <button type="submit" class="btn btn-success">Upload Material</button>
            <button type="button" class="btn btn-secondary" (click)="isUploadMaterialsVisible = false">Cancel</button>
          </form>
        </div>
      </div>

      <!-- Show uploaded materials for the current lesson -->
      <div *ngFor="let material of lesson.learningMaterials" class="material-card">
        <h5>{{ material.title }}</h5>
        <p>{{ material.description }}</p>
        <button class="btn btn-danger" (click)="deleteMaterial(course._id, lesson._id, material._id)">Delete
          Material</button>
        <button class="btn btn-success" (click)="showAddQuizForm(course._id, lesson._id)">Add Quiz</button>

        <!-- Add Quiz Form Modal -->
        <div *ngIf="isAddQuizVisible && currentCourseId === course._id && currentLessonId === lesson._id"
          class="form-modal">
          <div class="form-container">
            <h5>Add Quiz</h5>
            <form (ngSubmit)="createQuiz(lesson._id)">
              <div class="form-group">
                <label for="quizTitle">Quiz Title:</label>
                <input type="text" id="quizTitle" [(ngModel)]="newQuiz.title" name="quizTitle" required>
              </div>

              <!-- Loop through each question and add form fields for them -->
              <div *ngFor="let question of newQuiz.questions; let i = index" class="form-group">
                <label for="question{{ i }}">Question {{ i + 1 }}:</label>
                <input type="text" id="question{{ i }}" [(ngModel)]="question.question" name="question{{ i }}" required>

                <label for="options{{ i }}">Options (comma-separated):</label>
                <input type="text" id="options{{ i }}" [(ngModel)]="question.options" name="options{{ i }}" required>

                <label for="correctAnswer{{ i }}">Correct Answer:</label>
                <input type="text" id="correctAnswer{{ i }}" [(ngModel)]="question.correctAnswer"
                  name="correctAnswer{{ i }}" required>
              </div>

              <!-- Add Another Question Button -->
              <button type="button" class="btn btn-info" (click)="addAnotherQuestion()">Add Another Question</button>

              <button type="submit" class="btn btn-success">Submit Quiz</button>
              <button type="button" class="btn btn-secondary" (click)="isAddQuizVisible = false">Cancel</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>